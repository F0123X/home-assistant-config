# # # # # # # # # # # # # # # # # # # # # # #
#                     #                     #
#                   #   #                   #
#                 #       #                 #
#               #           #               #
#             #     Home      #             #
#           #                   #           #
#         # # #   Assistant   # # #         #
#             #               #             #
#             #               #             #
#             #               #             #
#             #               #             #
#             # # # # # # # # #             #
#                                           #
# # # # # # # # # # # # # # # # # # # # # # #
alias: Say
sequence:
  - service: script.pause_tv
  - service: script.sonos_say
    data_template:
      master: "{{ master }}"
      volume: "{{ volume }}"
      message: "{{ message }}"
      entity_id: >-
        {% if entity_id | length == 0 %}
          {% set entity_id = [
            'media_player.living_room_sonos',
            'media_player.family_room_sonos',
            'media_player.dining_room_sonos'
          ] %}
        {% endif %}

        {% if entity_id is not string and entity_id is sequence %}
          {% if {{ master }} not in entity_id %}
          {{ entity_id.append({{ master }})
          {% endif %}
          {% set entity_id = entity_id|join(', ') %}
        {% endif %}
        
        {{ entity_id }}
  - service: script.play_tv
